<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"><title>ICU Coherence Kernel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .vault-green { background: #10b981; box-shadow: 0 0 20px #10b981; }
        .vault-red { background: #ef4444; box-shadow: 0 0 20px #ef4444; }
    </style>
</head>
<body class="bg-slate-900 text-white p-5 font-mono">
    <div class="max-w-md mx-auto space-y-4">
        <div id="status-light" class="w-20 h-20 mx-auto rounded-full bg-slate-800 transition-all duration-500 flex items-center justify-center text-[10px] font-black">IDLE</div>
        <div class="grid grid-cols-2 gap-2">
            <input type="number" id="v0" placeholder="SysBP" class="bg-black p-2 rounded border border-slate-700">
            <input type="number" id="v1" placeholder="DiaBP" class="bg-black p-2 rounded border border-slate-700">
            </div>
        <button onclick="runTrial()" class="w-full bg-indigo-600 py-3 rounded font-bold">PROCESS TRIAL</button>
        <div id="logs" class="text-[10px] bg-black p-3 rounded h-40 overflow-y-auto mt-4"></div>
    </div>

    <script>
        async function runTrial() {
            const v = [
                parseFloat(document.getElementById('v0').value) || 120,
                parseFloat(document.getElementById('v1').value) || 80,
                72, 98, 16, 36.6, 100, 1500, 1.2, 7500
            ];
            try {
                const r = await fetch('/api', {
                    method: 'POST',
                    body: JSON.stringify({ vitals: v, gadgetTime: new Date().toLocaleTimeString() })
                });
                const d = await r.json();
                document.getElementById('status-light').innerText = d.score;
                document.getElementById('status-light').className = `w-20 h-20 mx-auto rounded-full flex items-center justify-center text-[10px] font-black ${d.score < 0.368 ? 'vault-red' : 'vault-green'}`;
                document.getElementById('logs').innerHTML += `<div>${d.timestamp}: ${d.verdict} (${d.score})</div>`;
            } catch (e) { alert("Vault Connection Error"); }
        }
    </script>
</body>
</html>
